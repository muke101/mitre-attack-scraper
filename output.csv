 
Windows Remote Management,Windows Remote Management,"Windows Remote Management (WinRM) is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services).  It may be called with the winrm command or by any number of programs such as PowerShell. "
Windows Remote Management,Mitigation,"Disable the WinRM service. If the service is necessary, lock down critical enclaves with separate WinRM infrastructure, accounts, and permissions. Follow WinRM best practices on configuration of authentication methods and use of host firewalls to restrict WinRM access to allow communication only to/from specific devices. "
Windows Remote Management,Detection,"Monitor use of WinRM within an environment by tracking service execution. If it is not normally used or is disabled, then this may be an indicator of suspicious behavior. Monitor processes created and actions taken by the WinRM process or a WinRM invoked script to correlate it with other related events."
Windows Remote Management,ID,T1028
Windows Remote Management,Tactic,"Execution, Lateral Movement"
Windows Remote Management,Platform: ,Windows
Windows Remote Management,System Requirements: ,WinRM listener turned on and configured on remote system
Windows Remote Management,Permissions Required: ,"User, Administrator"
Windows Remote Management,Data Sources: ,"File monitoring, Authentication logs, Netflow/Enclave netflow, Process monitoring, Process command-line parameters"
Windows Remote Management,Supports Remote: ,Yes
"
"
 
File System Permissions Weakness,File System Permissions Weakness,
File System Permissions Weakness,Services,
File System Permissions Weakness,Executable Installers,"Another variation of this technique can be performed by taking advantage of a weakness that is common in executable, self-extracting installers. During the installation process, it is common for installers to use a subdirectory within the %TEMP% directory to unpack binaries such as DLLs, EXEs, or other payloads. When installers create subdirectories and files they often do not set appropriate permissions to restrict write access, which allows for execution of untrusted code placed in the subdirectories or overwriting of binaries used in the installation process. This behavior is related to and may take advantage of DLL Search Order Hijacking. Some installers may also require elevated privileges that will result in privilege escalation when executing adversary controlled code. This behavior is related to Bypass User Account Control. Several examples of this weakness in existing common installers have been reported to software vendors.  "
File System Permissions Weakness,Mitigation,Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service binary target path locations. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses. 
File System Permissions Weakness,Detection,"Look for changes to binaries and service executables that may normally occur during software updates. If an executable is written, renamed, and/or moved to match an existing service executable, it could be detected and correlated with other suspicious behavior. Hashing of binaries and service executables could be used to detect replacement against historical data."
File System Permissions Weakness,ID,T1044
File System Permissions Weakness,Tactic,"Persistence, Privilege Escalation"
File System Permissions Weakness,Platform: ,Windows
File System Permissions Weakness,Permissions Required: ,"Administrator, User"
File System Permissions Weakness,Effective Permissions: ,"SYSTEM, User, Administrator"
File System Permissions Weakness,Data Sources: ,"File monitoring, Services, Process command-line parameters"
File System Permissions Weakness,CAPEC ID: ,
"
"
